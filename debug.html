<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WordSaver æ’ä»¶è°ƒè¯•å·¥å…·</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #4285f4;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .status-check {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .check-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            border-radius: 6px;
        }
        
        .check-ok {
            background: #e8f5e8;
            color: #0f9d58;
        }
        
        .check-error {
            background: #fce8e6;
            color: #d32f2f;
        }
        
        .check-warning {
            background: #fff3e0;
            color: #ff9800;
        }
        
        .icon {
            margin-right: 10px;
            font-size: 18px;
        }
        
        .test-section {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
        
        .test-word {
            background: #2196f3;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            display: inline-block;
            margin: 5px;
            font-weight: bold;
        }
        
        button {
            background: #4285f4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        
        button:hover {
            background: #3367d6;
        }
        
        .log-section {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        
        .instructions {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px 20px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ WordSaver æ’ä»¶è°ƒè¯•å·¥å…·</h1>
        
        <div class="instructions">
            <h3>ğŸ“‹ ä½¿ç”¨è¯´æ˜ï¼š</h3>
            <ol>
                <li>ç¡®ä¿ WordSaver æ’ä»¶å·²åœ¨æµè§ˆå™¨ä¸­å®‰è£…å¹¶å¯ç”¨</li>
                <li>ç‚¹å‡»ä¸‹æ–¹"æ£€æŸ¥æ’ä»¶çŠ¶æ€"æŒ‰é’®</li>
                <li>å°†é¼ æ ‡æ‚¬åœåœ¨è“è‰²æµ‹è¯•å•è¯ä¸Š</li>
                <li>æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—äº†è§£è¯¦ç»†ä¿¡æ¯</li>
            </ol>
        </div>

        <div class="status-check">
            <h3>ğŸ” æ’ä»¶çŠ¶æ€æ£€æŸ¥</h3>
            <button onclick="checkExtensionStatus()">æ£€æŸ¥æ’ä»¶çŠ¶æ€</button>
            <div id="status-results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ¯ æ‚¬åœç¿»è¯‘æµ‹è¯•</h3>
            <p>å°†é¼ æ ‡æ‚¬åœåœ¨ä¸‹é¢çš„å•è¯ä¸Šæµ‹è¯•ç¿»è¯‘åŠŸèƒ½ï¼š</p>
            <div>
                <span class="test-word">hello</span>
                <span class="test-word">beautiful</span>
                <span class="test-word">technology</span>
                <span class="test-word">amazing</span>
                <span class="test-word">intelligence</span>
            </div>
            <p style="margin-top: 15px; font-size: 14px; color: #666;">
                ğŸ’¡ å¦‚æœçœ‹åˆ°ç¿»è¯‘å¼¹çª—ï¼Œè¯´æ˜æ’ä»¶æ­£å¸¸å·¥ä½œ
            </p>
        </div>

        <div class="test-section">
            <h3>ğŸ”§ æ’ä»¶æ§åˆ¶é¢æ¿</h3>
            <p>æŸ¥çœ‹é¡µé¢å³ä¸‹è§’æ˜¯å¦æœ‰è“è‰²çš„"W"æŒ‰é’®</p>
            <button onclick="highlightControlArea()">é«˜äº®æ§åˆ¶é¢æ¿</button>
            <button onclick="showControlInfo()">æ˜¾ç¤ºæ§åˆ¶é¢æ¿ä¿¡æ¯</button>
        </div>

        <div class="log-section">
            <h4>ğŸ“ è°ƒè¯•æ—¥å¿—:</h4>
            <div id="debug-log"></div>
        </div>

        <div class="status-check">
            <h3>ğŸ› ï¸ å¸¸è§é—®é¢˜è§£å†³</h3>
            <button onclick="reloadExtension()">é‡æ–°åŠ è½½æ‰©å±•</button>
            <button onclick="clearStorage()">æ¸…é™¤å­˜å‚¨æ•°æ®</button>
            <button onclick="testPopup()">æµ‹è¯•å¼¹çª—</button>
            <button onclick="showTroubleshooting()">æ˜¾ç¤ºæ•…éšœæ’é™¤æŒ‡å—</button>
        </div>
    </div>

    <script>
        let logElement = document.getElementById('debug-log');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const colors = {
                info: '#333',
                success: '#0f9d58',
                error: '#d32f2f',
                warning: '#ff9800'
            };
            
            logElement.innerHTML += `
                <div style="color: ${colors[type]}; margin-bottom: 5px;">
                    [${timestamp}] ${message}
                </div>
            `;
            logElement.scrollTop = logElement.scrollHeight;
        }

        function checkExtensionStatus() {
            log('å¼€å§‹æ£€æŸ¥æ’ä»¶çŠ¶æ€...', 'info');
            const resultsDiv = document.getElementById('status-results');
            resultsDiv.innerHTML = '';
            
            const checks = [
                {
                    name: 'æ£€æŸ¥ Chrome æ‰©å±• API',
                    check: () => typeof chrome !== 'undefined' && chrome.runtime,
                    fix: 'è¯·ç¡®ä¿åœ¨ Chrome æµè§ˆå™¨ä¸­æ‰“å¼€æ­¤é¡µé¢'
                },
                {
                    name: 'æ£€æŸ¥å†…å®¹è„šæœ¬å…ƒç´ ',
                    check: () => document.getElementById('wordsaver-hover-control'),
                    fix: 'æ’ä»¶å¯èƒ½æœªæ­£ç¡®åŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢æˆ–é‡æ–°å®‰è£…æ’ä»¶'
                },
                {
                    name: 'æ£€æŸ¥å·¥å…·æç¤ºå…ƒç´ ',
                    check: () => document.getElementById('wordsaver-tooltip'),
                    fix: 'å†…å®¹è„šæœ¬å¯èƒ½æœªå®Œå…¨åˆå§‹åŒ–'
                },
                {
                    name: 'æ£€æŸ¥æ‰©å±•é€šä¿¡',
                    check: () => {
                        if (typeof chrome !== 'undefined' && chrome.runtime) {
                            try {
                                chrome.runtime.sendMessage({action: 'ping'}, (response) => {
                                    log(`æ‰©å±•å“åº”: ${JSON.stringify(response)}`, 'success');
                                });
                                return true;
                            } catch (e) {
                                log(`æ‰©å±•é€šä¿¡é”™è¯¯: ${e.message}`, 'error');
                                return false;
                            }
                        }
                        return false;
                    },
                    fix: 'æ‰©å±•åå°è„šæœ¬å¯èƒ½æœªè¿è¡Œï¼Œè¯·æ£€æŸ¥æ‰©å±•ç®¡ç†é¡µé¢'
                }
            ];
            
            checks.forEach(check => {
                const result = check.check();
                const status = result ? 'check-ok' : 'check-error';
                const icon = result ? 'âœ…' : 'âŒ';
                
                resultsDiv.innerHTML += `
                    <div class="check-item ${status}">
                        <span class="icon">${icon}</span>
                        <div>
                            <strong>${check.name}</strong>
                            ${!result ? `<br><small>è§£å†³æ–¹æ¡ˆ: ${check.fix}</small>` : ''}
                        </div>
                    </div>
                `;
                
                log(`${check.name}: ${result ? 'é€šè¿‡' : 'å¤±è´¥'}`, result ? 'success' : 'error');
            });
        }

        function highlightControlArea() {
            const controlArea = document.getElementById('wordsaver-hover-control');
            if (controlArea) {
                controlArea.style.border = '3px solid red';
                controlArea.style.animation = 'pulse 1s infinite';
                log('æ§åˆ¶é¢æ¿å·²é«˜äº®æ˜¾ç¤º', 'success');
                
                setTimeout(() => {
                    controlArea.style.border = '';
                    controlArea.style.animation = '';
                }, 3000);
            } else {
                log('æœªæ‰¾åˆ°æ§åˆ¶é¢æ¿å…ƒç´ ', 'error');
            }
        }

        function showControlInfo() {
            const controlArea = document.getElementById('wordsaver-hover-control');
            if (controlArea) {
                const rect = controlArea.getBoundingClientRect();
                log(`æ§åˆ¶é¢æ¿ä½ç½®: x=${rect.left}, y=${rect.top}, å¯è§=${controlArea.style.display !== 'none'}`, 'info');
            } else {
                log('æ§åˆ¶é¢æ¿ä¸å­˜åœ¨ - æ’ä»¶å¯èƒ½æœªåŠ è½½', 'error');
            }
        }

        function reloadExtension() {
            if (typeof chrome !== 'undefined' && chrome.runtime) {
                chrome.runtime.reload();
                log('æ­£åœ¨é‡æ–°åŠ è½½æ‰©å±•...', 'warning');
            } else {
                log('æ— æ³•é‡æ–°åŠ è½½æ‰©å±• - Chrome API ä¸å¯ç”¨', 'error');
            }
        }

        function clearStorage() {
            if (typeof chrome !== 'undefined' && chrome.storage) {
                chrome.storage.local.clear(() => {
                    log('æ‰©å±•å­˜å‚¨æ•°æ®å·²æ¸…é™¤', 'warning');
                });
            } else {
                log('æ— æ³•æ¸…é™¤å­˜å‚¨ - Chrome Storage API ä¸å¯ç”¨', 'error');
            }
        }

        function testPopup() {
            if (typeof chrome !== 'undefined' && chrome.action) {
                chrome.action.openPopup();
                log('å°è¯•æ‰“å¼€æ‰©å±•å¼¹çª—', 'info');
            } else {
                log('æ— æ³•æµ‹è¯•å¼¹çª— - Chrome Action API ä¸å¯ç”¨', 'error');
            }
        }

        function showTroubleshooting() {
            const troubleshooting = `
1. ç¡®è®¤æ’ä»¶å·²å®‰è£…ï¼š
   - æ‰“å¼€ chrome://extensions/
   - ç¡®è®¤ WordSaver æ’ä»¶å·²å¯ç”¨
   - æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯

2. åˆ·æ–°é¡µé¢ï¼š
   - æŒ‰ F5 æˆ– Ctrl+R åˆ·æ–°å½“å‰é¡µé¢
   - ç¡®ä¿å†…å®¹è„šæœ¬é‡æ–°åŠ è½½

3. æ£€æŸ¥æƒé™ï¼š
   - ç¡®è®¤æ’ä»¶æœ‰è®¿é—®å½“å‰ç½‘ç«™çš„æƒé™
   - æ£€æŸ¥æ˜¯å¦è¢«å¹¿å‘Šæ‹¦æˆªå™¨é˜»æ­¢

4. æŸ¥çœ‹æ§åˆ¶å°ï¼š
   - æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
   - æŸ¥çœ‹ Console æ ‡ç­¾ä¸­çš„é”™è¯¯ä¿¡æ¯

5. é‡æ–°å®‰è£…ï¼š
   - å¸è½½å½“å‰æ’ä»¶
   - é‡æ–°å®‰è£…æœ€æ–°ç‰ˆæœ¬
            `;
            
            alert(troubleshooting);
            log('å·²æ˜¾ç¤ºæ•…éšœæ’é™¤æŒ‡å—', 'info');
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥
        window.addEventListener('load', () => {
            log('è°ƒè¯•å·¥å…·å·²åŠ è½½', 'success');
            setTimeout(checkExtensionStatus, 1000);
        });

        // ç›‘å¬æ§åˆ¶å°é”™è¯¯
        window.addEventListener('error', (e) => {
            log(`JavaScripté”™è¯¯: ${e.message}`, 'error');
        });
    </script>
</body>
</html> 